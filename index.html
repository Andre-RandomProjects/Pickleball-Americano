<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pickleball Americano Generator</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      padding: 15px;
      margin: 0;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    h2 {
      margin-top: 0;
    }

    label {
      font-weight: bold;
    }

    textarea, input, button {
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
      margin-top: 6px;
    }

    textarea {
      height: 160px;
    }

    input[type="number"] {
      max-width: 120px;
    }

    button {
      padding: 12px;
      margin-top: 12px;
      cursor: pointer;
      border: none;
      border-radius: 6px;
      background: #1976d2;
      color: white;
      font-weight: bold;
    }

    button:hover {
      background: #125ea7;
    }

    .round {
      background: #ffffff;
      border-radius: 10px;
      padding: 15px;
      margin-top: 18px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      position: relative;
      transition: opacity 0.3s, background 0.3s;
    }

    .round.completed {
      opacity: 0.6;
      background: #eef6ee;
    }

    .round h3 {
      margin: 0 0 8px 0;
      border-bottom: 1px solid #eee;
      padding-bottom: 6px;
    }

    .complete-toggle {
      position: absolute;
      top: 12px;
      right: 12px;
      font-size: 14px;
    }

   /* Mobile fix */
   @media (max-width: 480px) {
     .complete-toggle {
      position: static;
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      } 
    }

    .courts {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    .court {
      background: #f9fafb;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      border: 1px solid #e3e6ea;
    }

    .court-title {
      font-weight: bold;
      margin-bottom: 6px;
    }

    .team {
      padding: 8px;
      border-radius: 6px;
      margin: 4px 0;
      background: #eaf2ff;
    }

    .vs {
      font-weight: bold;
      margin: 4px 0;
      color: #555;
    }

    .sitout {
      margin-top: 10px;
      font-style: italic;
      color: #666;
    }

    /* Tablet */
    @media (min-width: 600px) {
      .courts {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Desktop */
    @media (min-width: 900px) {
      .courts {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
    }
  </style>
</head>
<body>

<div class="container">

<h2>üèì Pickleball Americano Generator</h2>

<label>Number of courts</label>
<input type="number" id="courts" value="2">

<label>Player names (one per line)</label>
<textarea id="players"></textarea>

<button onclick="confirmGenerate()">Generate Schedule</button>

<div id="output"></div>

</div>

<script>
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function toggleCompleted(checkbox) {
  const roundDiv = checkbox.closest(".round");
  roundDiv.classList.toggle("completed", checkbox.checked);
}

function confirmGenerate() {
  const output = document.getElementById("output");
  if (output.children.length > 0) {
    const ok = confirm(
      "This will generate a new schedule and clear the current one.\n\nDo you want to continue?"
    );
    if (!ok) return;
  }
  generate();
}

function generate() {
  const courts = parseInt(document.getElementById("courts").value);
  const allPlayers = document.getElementById("players").value
    .split("\n")
    .map(p => p.trim())
    .filter(p => p !== "");

  const perRound = courts * 4;

  if (allPlayers.length < perRound) {
    alert("Not enough players for the number of courts");
    return;
  }

  const rounds = allPlayers.length;

  const sitOutQueue = [...allPlayers];
  shuffle(sitOutQueue);

  const output = document.getElementById("output");
  output.innerHTML = "";

  for (let r = 0; r < rounds; r++) {

    const sitOutCount = Math.max(0, allPlayers.length - perRound);
    const sitOutPlayers = sitOutQueue.splice(0, sitOutCount);

    const activePlayers = allPlayers.filter(
      p => !sitOutPlayers.includes(p)
    );

    shuffle(activePlayers);

    const roundDiv = document.createElement("div");
    roundDiv.className = "round";

    roundDiv.innerHTML = `
      <label class="complete-toggle">
        <input type="checkbox" onchange="toggleCompleted(this)"> Completed
      </label>
      <h3>Round ${r + 1}</h3>
    `;

    const courtsDiv = document.createElement("div");
    courtsDiv.className = "courts";

    for (let c = 0; c < courts; c++) {
      const p = activePlayers.slice(c * 4, c * 4 + 4);

      const courtDiv = document.createElement("div");
      courtDiv.className = "court";

      courtDiv.innerHTML = `
        <div class="court-title">Court ${c + 1}</div>
        <div class="team">${p[0]} & ${p[2]}</div>
        <div class="vs">VS</div>
        <div class="team">${p[1]} & ${p[3]}</div>
      `;

      courtsDiv.appendChild(courtDiv);
    }

    roundDiv.appendChild(courtsDiv);

    if (sitOutPlayers.length) {
      const sitOutDiv = document.createElement("div");
      sitOutDiv.className = "sitout";
      sitOutDiv.innerHTML = `<strong>Sit out:</strong> ${sitOutPlayers.join(", ")}`;
      roundDiv.appendChild(sitOutDiv);
    }

    output.appendChild(roundDiv);
    sitOutQueue.push(...sitOutPlayers);
  }
}
</script>

</body>

</html>
